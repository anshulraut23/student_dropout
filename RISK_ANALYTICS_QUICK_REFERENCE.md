# ðŸŽ¯ Risk Analytics Quick Reference

## What is Risk Analytics?

The Risk Analytics system uses **Machine Learning + Explainable AI** to predict which students are at risk of dropping out. It continuously analyzes:
- **Attendance patterns** â†’ How often students come to class
- **Academic performance** â†’ Exam scores and marks percentage
- **Behavior** â†’ Disciplinary incidents and conduct

## How to Access

1. **Log in** as a teacher or admin
2. Go to **Students** â†’ Click on any student
3. In the student profile, click the **"Risk"** tab
4. See the AI-powered risk prediction!

## What You'll See

### Risk Card (Main View)
- **Large colored badge** showing risk level (Green/Yellow/Orange/Red)
- **Risk Score**: Percentage likelihood of dropout (0-100%)
- **Confidence**: How sure the AI is (Low/Medium/High)
- **AI Analysis**: Human-readable explanation from Gemini AI

### Risk Breakdown
- **Attendance Risk**: How much low attendance contributes
- **Academic Risk**: How much low marks contribute
- **Behavior Risk**: How much behavioral issues contribute

### Feature Importance
- Shows which factors the ML model considers most important
- Sorted from highest to lowest impact
- Example: "Avg Marks: 26.1% importance"

### Recommendations
- **Priority Actions**: Urgent things to do immediately
- **All Recommendations**: Additional steps (expandable)
- Generated by Gemini AI based on the student's specific situation

## Risk Levels Explained

| Level | Color | Meaning | Action |
|-------|-------|---------|--------|
| **LOW** | ðŸŸ¢ Green | Student is doing well | Continue monitoring |
| **MEDIUM** | ðŸŸ¡ Yellow | Some concerning patterns | Schedule check-in |
| **HIGH** | ðŸŸ  Orange | Significant risk signals | Immediate intervention needed |
| **CRITICAL** | ðŸ”´ Red | Very high dropout risk | Urgent counselor meeting required |

## When Predictions Appear

The system shows "Building Prediction Data" if the student is new. Predictions unlock when:
- âœ… **14+ days** of attendance records exist
- âœ… **1+ exam** scores are recorded

After that, predictions update automatically as new data flows in.

## System Status

### Services Running
- **ML Service**: http://localhost:5001
  - Has the trained ML model
  - Connected to Gemini AI
  - Generates predictions

- **Backend**: http://localhost:5000
  - Fetches student data from Supabase
  - Orchestrates ML predictions
  - Stores results

- **Frontend**: http://localhost:5173
  - Beautiful UI for teachers
  - Real-time risk updates
  - Interactive dashboards

## Testing the System

### Quick Test
```bash
node test-risk-analytics-comprehensive.js
```

Expected output:
```
âœ… ML Service Health
âœ… ML Prediction - Low Risk
âœ… ML Prediction - High Risk
âœ… Feature Importance
âœ… Gemini AI Explanations
âœ… Error Handling
Passed: 6/6 (100%)
```

### What Gets Tested
1. ML service is running and healthy
2. Low-risk predictions work correctly
3. High-risk predictions identify at-risk students
4. Feature importance is ranked properly
5. Gemini AI generates explanations
6. Error handling for insufficient data

## Common Questions

**Q: How accurate is the AI?**
A: The model has ~70% accuracy and is constantly improving with more real data.

**Q: Can I trust the predictions?**
A: Yes! The system shows which features most impact the prediction (Feature Importance) so you can verify the reasoning.

**Q: What if predictions seem wrong?**
A: The system learns from real data over time. More attendance + exam data = more accurate predictions.

**Q: Can I export the predictions?**
A: Currently shown in UI. Can be extended to export as CSV/PDF.

**Q: What if a student has low attendance but high marks?**
A: The system balances all factors. One good metric doesn't override concerning patterns in others.

## Troubleshooting

| Problem | Solution |
|---------|----------|
| **"Building Prediction Data" appears** | Normal for new students. Need more attendance/exam records. |
| **Predictions say "Critical" but student seems fine** | Check individual factors (attendance, marks, behavior). AI might be catching hidden patterns. |
| **No risk predictions showing at all** | Ensure ML Service is running: `python ml-service/app.py` |
| **Predictions haven't updated in a while** | New attendance/exam data triggers updates automatically. |
| **"Gemini not available" message** | Some recommendations will use fallback text. Rest of system still works. |

## For Developers

### How It Works (Technical)
1. Frontend calls `/api/ml/risk/student/{id}`
2. Backend extracts features from Supabase (attendance, marks, behavior)
3. Backend sends features to ML Service (Python Flask on port 5001)
4. ML Service:
   - Runs Random Forest prediction
   - Calls Gemini API for explanation
   - Generates recommendations
5. Backend returns full prediction to frontend
6. Frontend displays with beautiful UI

### Key Files
- Frontend: `proactive-education-assistant/src/pages/teacher/StudentProfilePage.jsx`
- Risk Card Component: `proactive-education-assistant/src/components/risk/StudentRiskCard.jsx`
- Backend: `backend/ml-integration/riskController.js`
- ML Service: `ml-service/app.py` + `ml-service/models/`

### Configuration
- ML thresholds: `ml-service/config.py`
- Risk model: `ml-service/models/ml_predictor.py`
- Gemini prompts: `ml-service/models/gemini_explainer.py`

## Support

For issues:
1. Run: `node test-risk-analytics-comprehensive.js`
2. Check logs in terminal where ML service is running
3. See detailed docs: `RISK_ANALYTICS_README.md`

---

**Last Updated**: 2024
**Status**: âœ… Production Ready
**Tests Passing**: 6/6 (100%)
